
<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Winter Olympics Medal Table</title>

<style .footer {
  font-size:2vmin;
  opacity:0.85;
  margin-top:2vmin;
  text-align:center;
  letter-spacing:.5px;
}>
html, body {
  margin:0;
  height:100%;
  background:#0b0f18;
  color:#fff;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
}

.frame {
  width:100vmin;
  height:100vmin;
  margin:0 auto;
  padding:4vmin;
  box-sizing:border-box;
  background: radial-gradient(120% 120% at 20% 10%, #162447 0%, #0b0f18 55%, #05060a 100%);
  border:0.6vmin solid rgba(255,255,255,0.12);
  display:flex;
  flex-direction:column;
  position:relative;
  overflow:hidden;
}

/* Subtle shimmer */
.frame::before {
  content:"";
  position:absolute;
  top:-50%;
  left:-50%;
  width:200%;
  height:200%;
  background:linear-gradient(
    115deg,
    rgba(255,255,255,0.03) 25%,
    rgba(255,255,255,0.08) 50%,
    rgba(255,255,255,0.03) 75%
  );
  animation: shimmer 12s linear infinite;
}

@keyframes shimmer {
  from { transform: translateX(-50%) rotate(25deg); }
  to { transform: translateX(50%) rotate(25deg); }
}

.header {
  text-align:center;
  margin-bottom:2vmin;
}

.header img {
  width:18vmin;
  opacity:0.9;
}

.title {
  font-size:4vmin;
  font-weight:900;
  text-transform:uppercase;
  letter-spacing:1px;
  margin-top:1vmin;
}

.table {
  margin-top:3vmin;
  display:flex;
  flex-direction:column;
  gap:1.5vmin;
  flex:1;
  position:relative;
  z-index:2;
}

.row {
  display:grid;
  grid-template-columns:8vmin 1fr 12vmin 12vmin 12vmin 14vmin;
  padding:2vmin;
  border:0.25vmin solid rgba(255,255,255,0.1);
  background:rgba(255,255,255,0.04);
  align-items:center;
  animation: fadeSlide 0.6s ease;
}

@keyframes fadeSlide {
  from { opacity:0; transform:translateY(8px); }
  to { opacity:1; transform:translateY(0); }
}

.rank {
  font-size:4vmin;
  font-weight:900;
}

.country {
  font-size:3vmin;
  font-weight:900;
}

.cell {
  text-align:right;
  font-size:3vmin;
  font-weight:900;
}

.cell.gold { color:#FFD700; }
.cell.silver { color:#C0C0C0; }
.cell.bronze { color:#CD7F32; }

.total {
  font-size:3.6vmin;
  color:#ffffff;
}

.footer {
  font-size:2vmin;
  opacity:0.7;
  margin-top:2vmin;
  text-align:center;
}

.count {
  display:inline-block;
  min-width:2ch;
}
 .headerRow {
  font-weight:900;
  letter-spacing:1px;
}

.row {
  transform-origin:center;
}

</style>
</head>

<body>

<div class="frame">

  <div class="header">
    <svg viewBox="0 0 300 130" style="width:18vmin; opacity:0.9;">
  <circle cx="60" cy="65" r="30" stroke="#0085C7" stroke-width="8" fill="none"/>
  <circle cx="120" cy="65" r="30" stroke="#000000" stroke-width="8" fill="none"/>
  <circle cx="180" cy="65" r="30" stroke="#DF0024" stroke-width="8" fill="none"/>
  <circle cx="90" cy="95" r="30" stroke="#F4C300" stroke-width="8" fill="none"/>
  <circle cx="150" cy="95" r="30" stroke="#009F3D" stroke-width="8" fill="none"/>
</svg>
    <div class="title">2026 Winter Olympics Medal Count</div>
  </div>

  <div class="table">

  <div class="row headerRow" style="opacity:.6; background:none; border:none; animation:none;">
    <div>#</div>
    <div>Country</div>
    <div class="cell gold">ü•á</div>
    <div class="cell silver">ü•à</div>
    <div class="cell bronze">ü•â</div>
    <div class="cell total">üèÖ</div>
  </div>

  <div id="rows"></div>

</div>

  <div id="status" class="footer">Loading‚Ä¶</div>

</div>

<script>

const API = "https://script.google.com/macros/s/AKfycby3rRAJqUmgRc_pfnlrtjWx7Yof3IvhugY_-f7BxYjeksL5-eNRX67QXhTkIqvhmr4o/exec";

const iocToIso2 = {
  USA:"US", ITA:"IT", NOR:"NO", NED:"NL", AUT:"AT",
  GER:"DE", FRA:"FR", CAN:"CA", JPN:"JP", SUI:"CH",
  SWE:"SE", FIN:"FI", GBR:"GB", KOR:"KR", CHN:"CN"
};

let previousData = {};

function animateCount(el, start, end, duration=600) {
  const startTime = performance.now();
  function update(now) {
    const progress = Math.min((now - startTime)/duration, 1);
    el.textContent = Math.floor(progress*(end-start)+start);
    if(progress < 1) requestAnimationFrame(update);
  }
  requestAnimationFrame(update);
}

function flash(el) {
  el.style.transition = "background .3s ease";
  el.style.background = "rgba(255,255,255,0.25)";
  setTimeout(()=> el.style.background="transparent", 300);
}

async function load() {

  const container = document.getElementById("rows");
  const status = document.getElementById("status");

  try {
    const res = await fetch(API);
    const data = await res.json();

    const usa = data.top5.find(r => r.code === "USA");
    const usaTotal = usa ? usa.total : 0;

    const fragment = document.createDocumentFragment();

    data.top5.forEach((r) => {

      let row = document.getElementById("row_" + r.code);

      if(!row) {
        row = document.createElement("div");
        row.className = "row";
        row.id = "row_" + r.code;
        row.style.transition = "transform .6s ease, box-shadow .4s ease";
      }

      const iso = iocToIso2[r.code] || "";
      const flag = iso
        ? `<img src="https://flagcdn.com/w40/${iso.toLowerCase()}.png"
           style="vertical-align:middle;margin-right:8px;border-radius:4px;">`
        : "";

      const leaderGlow = r.rank === 1
        ? "box-shadow:0 0 30px rgba(255,215,0,0.5);"
        : "";

      const highlight = r.code === "USA"
        ? "background:rgba(0,80,255,0.2); border-color:rgba(255,255,255,0.5);"
        : "";

      const delta = r.total - usaTotal;
      const deltaDisplay = r.code === "USA"
        ? ""
        : `<div style="font-size:2vmin; opacity:.5;">${delta>0? "+"+delta : delta}</div>`;

      row.style.cssText += leaderGlow + highlight;

      row.innerHTML = `
        <div class="rank">${r.rank}</div>
        <div class="country">${flag}${r.name}</div>
        <div class="cell gold"><span class="count" data-type="gold">${r.gold}</span></div>
        <div class="cell silver"><span class="count" data-type="silver">${r.silver}</span></div>
        <div class="cell bronze"><span class="count" data-type="bronze">${r.bronze}</span></div>
        <div class="cell total">
          <span class="count" data-type="total">${r.total}</span>
          ${deltaDisplay}
        </div>
      `;

      const prev = previousData[r.code];

      if(prev) {
        ["gold","silver","bronze","total"].forEach(type=>{
          if(r[type] > prev[type]) {
            const el = row.querySelector(`[data-type="${type}"]`);
            flash(el);
          }
        });
      }

      previousData[r.code] = r;

      fragment.appendChild(row);
    });

    container.innerHTML = "";
    container.appendChild(fragment);

    status.textContent = "‚óè LIVE  |  Updated: " + new Date(data.updatedAt).toLocaleString();

  } catch(err) {
    console.error(err);
    status.textContent = "Data load failed";
  }
}

load();
setInterval(load, 60000);

</script>



</body>
</html>

