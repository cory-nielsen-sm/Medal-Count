<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Winter Olympics Medal Table</title>
<style .row {
  animation: fadeSlide 0.6s ease;
}

@keyframes fadeSlide {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}>
html, body {
  margin:0;
  height:100%;
  background:#0b0f18;
  color:#fff;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
}
.frame {
  width:100vmin;
  height:100vmin;
  margin:0 auto;
  padding:4vmin;
  box-sizing:border-box;
  background: radial-gradient(120% 120% at 20% 10%, #162447 0%, #0b0f18 55%, #05060a 100%);
  border:0.6vmin solid rgba(255,255,255,0.12);
  display:flex;
  flex-direction:column;
}
.title {
  font-size:4.5vmin;
  font-weight:900;
  text-transform:uppercase;
}
.table {
  margin-top:3vmin;
  display:flex;
  flex-direction:column;
  gap:1.5vmin;
  flex:1;
}
.row {
  display:grid;
  grid-template-columns:8vmin 1fr 12vmin 12vmin 12vmin 14vmin;
  padding:2vmin;
  border:0.25vmin solid rgba(255,255,255,0.1);
  background:rgba(255,255,255,0.04);
  align-items:center;
}
.rank { font-size:4vmin; font-weight:900; }
.country { font-size:3vmin; font-weight:900; }
.cell { text-align:right; font-size:3vmin; font-weight:900; }
.total { font-size:3.5vmin; }
.footer { font-size:2vmin; opacity:0.7; margin-top:2vmin; }
</style>
</head>
<body>
<div class="frame">
  <div class="title">2026 Winter Olympics Medals</div>
  <div id="table" class="table"></div>
  <div id="status" class="footer">Loading…</div>
</div>
  
<script>

const API = "https://script.google.com/macros/s/AKfycby3rRAJqUmgRc_pfnlrtjWx7Yof3IvhugY_-f7BxYjeksL5-eNRX67QXhTkIqvhmr4o/exec";

let previousRanks = {};

function getMovement(rank, code) {
  if (!previousRanks[code]) return "";
  if (previousRanks[code] > rank) return "▲";
  if (previousRanks[code] < rank) return "▼";
  return "";
}

async function load() {
  const table = document.getElementById("table");
  const status = document.getElementById("status");

  try {
    const res = await fetch(API);
    const data = await res.json();

    if (!data.top5 || !data.top5.length) {
      status.textContent = "No medal data";
      return;
    }

    const html = data.top5.map((r) => {
      const movement = getMovement(r.rank, r.code);
      previousRanks[r.code] = r.rank;

      const highlight = r.code === "USA"
        ? "background:rgba(0,80,255,0.15); border-color:rgba(255,255,255,0.4);"
        : "";

      return `
        <div class="row" style="${highlight}">
          <div class="rank">${r.rank} ${movement}</div>
          <div class="country">
            <img src="https://flagcdn.com/w40/${r.code.toLowerCase()}.png" style="vertical-align:middle;margin-right:8px;border-radius:4px;">
            ${r.name}
          </div>
          <div class="cell">${r.gold}</div>
          <div class="cell">${r.silver}</div>
          <div class="cell">${r.bronze}</div>
          <div class="cell total">${r.total}</div>
        </div>
      `;
    }).join("");

    table.innerHTML = html;

    status.textContent = "Updated: " + new Date(data.updatedAt).toLocaleString();

  } catch (err) {
    console.error(err);
    status.textContent = "Data load failed";
  }
}

load();
setInterval(load, 60000); // 1 minute refresh

</script>

</body>
</html>
